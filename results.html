<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ุงููุชุงุฆุฌ ุงูููุงุฆูุฉ | ุชุญุฏู ูุฑุฉ ุงููุฏู</title>
    <link rel="stylesheet" href="css/style.css">
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>
</head>
<body>
    <div class="container">
        <div class="results-screen">
            <h1>ุงูุชูุช ุฌููุฉ "ูุงุฐุง ุชุนุฑูุ"</h1>
            
            <div class="results-container">
                <div class="player-result">
                    <h2 id="player1-name">ุงููุงุนุจ 1</h2>
                    <div class="final-score" id="player1-score">0</div>
                </div>
                
                <div class="vs">VS</div>
                
                <div class="player-result">
                    <h2 id="player2-name">ุงููุงุนุจ 2</h2>
                    <div class="final-score" id="player2-score">0</div>
                </div>
            </div>
            
            <div class="winner-announcement" id="winner-announcement"></div>
            
            <div class="buttons-container">
                <a href="index.html" class="btn primary">ุงูุนูุฏุฉ ููุฑุฆูุณูุฉ</a>
                <a href="#" id="play-again-btn" class="btn secondary">ูุนุจ ุฌููุฉ ุฌุฏูุฏุฉ</a>
            </div>
        </div>
    </div>

    <script src="js/config.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // ุงูุญุตูู ุนูู ูุนูููุงุช ุงููุนุจุฉ ูู ุงูุชุฎุฒูู ุงููุญูู ุฃู ูุนููุงุช URL
            const roomCode = localStorage.getItem('roomCode');
            const playerId = localStorage.getItem('playerId');
            
            if (!roomCode) {
                window.location.href = 'index.html';
                return;
            }
            
            // ูุฑุฌุน ุงูุบุฑูุฉ
            const roomRef = database.ref('rooms/' + roomCode);
            
            // ุงูุญุตูู ุนูู ุจูุงูุงุช ุงูุบุฑูุฉ
            roomRef.once('value', snapshot => {
                if (!snapshot.exists()) {
                    window.location.href = 'index.html';
                    return;
                }
                
                const roomData = snapshot.val();
                const players = roomData.players || {};
                
                // ุนุฑุถ ุฃุณูุงุก ุงููุงุนุจูู ูุงูููุงุท
                if (players.player1) {
                    document.getElementById('player1-name').textContent = players.player1.name;
                    document.getElementById('player1-score').textContent = players.player1.score || 0;
                }
                
                if (players.player2) {
                    document.getElementById('player2-name').textContent = players.player2.name;
                    document.getElementById('player2-score').textContent = players.player2.score || 0;
                }
                
                // ุชุญุฏูุฏ ุงููุงุฆุฒ
                const score1 = players.player1?.score || 0;
                const score2 = players.player2?.score || 0;
                
                if (score1 > score2) {
                    document.getElementById('winner-announcement').textContent = `ุงููุงุฆุฒ: ${players.player1.name}! ๐`;
                    document.getElementById('player1-score').parentElement.classList.add('winner');
                } else if (score2 > score1) {
                    document.getElementById('winner-announcement').textContent = `ุงููุงุฆุฒ: ${players.player2.name}! ๐`;
                    document.getElementById('player2-score').parentElement.classList.add('winner');
                } else {
                    document.getElementById('winner-announcement').textContent = `ุชุนุงุฏู! ๐ค`;
                }
            });
            
            // ุฒุฑ ุงููุนุจ ูุฑุฉ ุฃุฎุฑู
            document.getElementById('play-again-btn').addEventListener('click', function(e) {
                e.preventDefault();
                
                // ุฅุนุงุฏุฉ ุชููุฆุฉ ุงูุบุฑูุฉ ูุฌููุฉ ุฌุฏูุฏุฉ
                roomRef.child('gameState').update({
                    currentQuestion: 0,
                    currentTurn: 'player1',
                    skipUsed: {},
                    usedAnswers: {}
                }).then(() => {
                    // ุฅุนุงุฏุฉ ุชุนููู ุงูุณุชุฑุงููุงุช
                    roomRef.child('players').update({
                        'player1/strikes': 0,
                        'player2/strikes': 0
                    }).then(() => {
                        // ุงูุงูุชูุงู ุฅูู ุตูุญุฉ ุงููุนุจุฉ
                        window.location.href = 'game.html?room=' + roomCode;
                    });
                });
            });
        });
    </script>
</body>
</html>
